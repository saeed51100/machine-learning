Please think long and hard.
I am developing a time-series classification pipeline in Python (Jupyter Notebook) to identify Forex price trend regimes based on historical price data.
The dataset consists of approximately 170,000 rows of Forex OHLCV data on the H1 (hourly) timeframe, with the following characteristics:

I have written following code that adds a Label column to df_model to represent the dominant price trend:
    0 → No meaningful trend
    1 → Bullish trend
    2 → Bearish trend

The current code works correctly and assigns labels 0 and 1 and 2 as intended.

* Question
Please write me a clean version of the code.

// my code:
