I am developing a time-series classification pipeline in Python (Jupyter Notebook) to identify Forex price trend regimes based on historical price data.
The dataset consists of approximately 170,000 rows of Forex OHLCV data on the H1 (hourly) timeframe, with the following characteristics:
* Dataset Description
     The dataset contains a 'CLOSE' price column and a corresponding 'Label' column that indicates price trend events with three classes:
        0 → No meaningful trend (sideways / flat movement)
        1 → Bullish trend
        2 → Bearish trend

* Question
I have written the following code that does the labeling of 0, 1, and 2.
Please modify my code to be more sensitive and detect smaller trends as well.

// my code
