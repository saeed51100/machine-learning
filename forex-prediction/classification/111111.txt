Please think long and hard.
I am developing a time-series classification pipeline in Python (Jupyter Notebook) to identify Forex price trend regimes based on historical price data.
The dataset consists of approximately 170,000 rows of Forex OHLCV data on the H1 (hourly) timeframe, with the following characteristics:
* Dataset Description
    1- The main DataFrame df contains 140,000 rows and 10 columns:
        DATETIME, DATE, TIME, OPEN, HIGH, LOW, CLOSE, TICKVOL, VOL, SPREAD.
    2- Each row represents one hour of Forex price data.
    3- The dataset is fully continuous; all weekend and holiday gaps have already been forward-filled.
    4- The DATETIME column is strictly chronological and represents the true time index.

I written the following code that adds a "Label" column to df_model with the following specifications:
The Label column should represent the dominant price trend as follows:
The Label column shows the dominant price trend as follows:
	1 → Bullish trend
        2 → Bearish trend
My code works correctly and labels price trends with 1 and 2.
My question:
Now I want to add a new logic to my code that also labels flat trends with 0:
0 → No meaningful trend (sideways / flat movement)
Please update my code so that the logic of 1s and 2s does not change and then the labeling of zeros is done.

// my code:
