
I have written Python code in a Jupyter Notebook that labels a dataset named df_model.
The dataset contains a close price column, and the code adds a label column that represents price trend behavior with three classes:

	0: no trend / undefined
	1: bullish trend (valley)
	2: bearish trend (peak)

The current logic correctly detects and labels local peaks (2) and valleys (1). All other rows between a detected valley and the next peak (or vice versa) are labeled as 0.

* Problem
While the peak and valley detection logic is correct, I do not want the rows between a valley and the next peak (or between a peak and the next valley) to remain labeled as 0.
Desired behavior

* After peaks and valleys are detected:
If a valley (1) is followed by a peak (2), all rows between them should be labeled 1 (bullish trend).
If a peak (2) is followed by a valley (1), all rows between them should be labeled 2 (bearish trend).

Only areas before the first detected extremum or after the last detected extremum may remain 0.

* Question
How should I modify my existing labeling code so that the spaces between consecutive peaks and valleys are filled with the appropriate trend label (1 or 2) instead of 0, while keeping the existing peak and valley detection logic unchanged?

// my code: